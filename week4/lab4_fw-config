set firewall zone WAN
set firewall zone DMZ
set firewall zone LAN
set firewall zone WAN member interface eth0
set firewall zone DMZ member interface eth1
set firewall zone LAN member interface eth2
set firewall ipv4 name WAN-to-DMZ default-action drop
set firewall ipv4 name DMZ-to-WAN default-action drop
set firewall ipv4 name WAN-to-DMZ default-log
set firewall ipv4 name DMZ-to-WAN default-log
set firewall zone WAN from DMZ firewall name DMZ-to-WAN
set firewall zone DMZ from WAN firewall name WAN-to-DMZ
set firewall ipv4 name WAN-to-DMZ rule 10 description "Allow HTTP from WAN to web01"
set firewall ipv4 name WAN-to-DMZ rule 10 action accept
set firewall ipv4 name WAN-to-DMZ rule 10 destination address 172.16.50.3
set firewall ipv4 name WAN-to-DMZ rule 10 destination port 80
set firewall ipv4 name WAN-to-DMZ rule 10 protocol tcp
set firewall ipv4 name DMZ-to-WAN rule 1 description "Allow packets back from DMZ to WAN"
set firewall ipv4 name DMZ-to-WAN rule 1 action accept
set firewall ipv4 name DMZ-to-WAN rule 1 state established
set firewall ipv4 name DMZ-to-LAN default-action drop
set firewall ipv4 name LAN-to-DMZ default-action drop
set firewall ipv4 name DMZ-to-LAN default-log 
set firewall ipv4 name LAN-to-DMZ default-log
set firewall zone LAN from DMZ firewall name DMZ-to-LAN 
set firewall zone DMZ from LAN firewall name LAN-to-DMZ
set firewall ipv4 name DMZ-to-LAN rule 10 description "Allow Wazuh agent communications"
set firewall ipv4 name DMZ-to-LAN rule 10 action accept
set firewall ipv4 name DMZ-to-LAN rule 10 destination address 172.16.200.10
set firewall ipv4 name DMZ-to-LAN rule 10 destination port 1514-1515
set firewall ipv4 name DMZ-to-LAN rule 10 protocol tcp
set firewall ipv4 name LAN-to-DMZ rule 1 description "Allow packets back from LAN to DMZ"
set firewall ipv4 name LAN-to-DMZ rule 1 action accept
set firewall ipv4 name LAN-to-DMZ rule 1 state established
set firewall ipv4 name LAN-to-WAN default-action drop
set firewall ipv4 name LAN-to-WAN default-log
set firewall zone WAN from LAN firewall name LAN-to-WAN
set firewall ipv4 name LAN-to-WAN rule 1 description "Allow LAN to WAN all connections"
set firewall ipv4 name LAN-to-WAN rule 1 action accept
set firewall ipv4 name WAN-to-LAN default-action drop
set firewall ipv4 name WAN-to-LAN default-log 
set firewall zone LAN from WAN firewall name WAN-to-LAN
set firewall ipv4 name WAN-to-LAN rule 1 description "Allow packets back from WAN to LAN"
set firewall ipv4 name WAN-to-LAN rule 1 action accept
set firewall ipv4 name WAN-to-LAN rule 1 state established
set firewall ipv4 name LAN-to-DMZ rule 20 description "Allow 80/tcp from LAN to web01"
set firewall ipv4 name LAN-to-DMZ rule 20 action accept
set firewall ipv4 name LAN-to-DMZ rule 20 destination address 172.16.50.3
set firewall ipv4 name LAN-to-DMZ rule 20 destination port 80
set firewall ipv4 name LAN-to-DMZ rule 20 protocol tcp
set firewall ipv4 name LAN-to-DMZ rule 21 description "Allow 22/tcp from mgmt01 to DMZ"
set firewall ipv4 name LAN-to-DMZ rule 21 action accept
set firewall ipv4 name LAN-to-DMZ rule 21 source address 172.16.150.10
set firewall ipv4 name LAN-to-DMZ rule 21 destination port 22
set firewall ipv4 name LAN-to-DMZ rule 21 protocol tcp
set firewall ipv4 name DMZ-to-LAN rule 1 description "Allow packets back from DMZ to LAN"
set firewall ipv4 name DMZ-to-LAN rule 1 action accept
set firewall ipv4 name DMZ-to-LAN rule 1 state established
